---
layout: default
---

<article>
  <nav class="toc">
    <div>دسترسی سریع</div>
    <ul>
      <li>
        <a href="#p0">تابع مرتبه بالا</a>
      </li>
      <li>
        <a href="#p1">خلاصه</a>
      </li>
    </ul>
  </nav>

  <section id="p0">
    <h2>تابع مرتبه بالا</h2>
    <p>
      در کاتلین همه چیز <a href="objects-and-classes.html">آبجکت (Object)</a> و
      دارای مقدار است حتی یک تابع.
    </p>
    <p>
      توابع در کاتلین
      <a
        href="https://en.wikipedia.org/wiki/First-class_function"
        class="text-decoration-none"
        >first-class</a
      >
      هستند یعنی میتونیم به یک متغیر اختصاصشون بدیم، به عنوان پارامتر به یک تابع
      دیگه پاس بدیم، به عنوان مقدار از یک تابع دیگه برشون گردونیم و در ساختار
      داده مرتبشون کنیم.
    </p>
    <p>
      تابع مرتبه بالا (<a
        class="text-decoration-none"
        href="https://en.wikipedia.org/wiki/Higher-order_function"
        >Higher-order function</a
      >) به تابعی گفته میشه که حداقل یک تابع به عنوان پارامتر بگیره یا یک تابع
      به عنوان مقدار برگردونه.
    </p>

    <p>
      برای تعریف توابع مرتبه بالا در کاتلین معمولا از
      <a
        class="text-decoration-none"
        href="/post/kotlin/anonymous-function-and-lambda.html"
        >توابع تحت لفظی</a
      >
      به عنوان پارامتر یا مقدار بازگشتی استفاده میکنیم.
    </p>

    <p>میتونیم از توابع تحت لفظی در پارامتر به عنوان callback استفاده کنیم.</p>

    <p>
      تابع setOnClickListener در اپلیکیشن نویسی معروفه و در اندروید زیاد استفاده
      میشه این تابع تقریبا مثل زیر تعریف شده و onclick یک callback برای
      setOnClickListener است.
    </p>

    <div class="sample">
      <div class="snippet-container">
        <pre class="snippet Kotlin">
setOnClickListener(onClick: (view: View) -&gt; Unit){
  var view: View = ...

  ...

  onClick(view)

  ...
}
                  </pre
        >
      </div>
    </div>

    <p>صدا زدن تابع:</p>

    <div class="sample">
      <div class="snippet-container">
        <pre class="snippet Kotlin">
setOnClickListener({ v -&gt; //Callback
  ...
})
                  </pre
        >
      </div>
    </div>

    <p>
      در بالا
      <strong>&#x200E;{ v -&gt; ...}</strong>
      مقدار لامبداییه که به پارامتر اختصاص دادیم.
    </p>

    <div class="note">
      <p class="note-head">توجه:</p>
      <p>
        هنگامی که عبارت لامبدا به عنوان اخرین پارامتر تابع تعریف شده باشه، در
        کاتلین موقع صدا زدن تابع میتونیم لامبدا رو بیرون از پرانتز به پارامتر
        اختصاص بدیم.
      </p>
    </div>

    <p>مثال:</p>

    <p>
      در زیر تابع myForeach وظیفه ی خوندن اعضای یک ارایه رو به عهده داره
      myForeach یک
      <a
        class="text-decoration-none"
        href="/post/kotlin/extension-function.html"
        >تابع اکستنشن</a
      >
      نیز است. مشابه تابع myForeach یک تابع به اسم foreach در api رسمی کاتلین
      وجود داره.
    </p>

    <div class="sample">
      <div class="snippet-container">
        <pre class="snippet Kotlin">
 fun &lt;E&gt; Array&lt;E&gt;.myForeach(accessor: (element: E) -&gt; Unit){
  for(e in this)
    accessor(e)
}
                  </pre
        >
      </div>
    </div>

    <p>صدا زدن تابع:</p>

    <div class="sample">
      <div class="snippet-container">
        <pre class="snippet Kotlin">
fun main(){
  
  val arr = arrayOf&lt;Int&gt;(9, 10, 8, 2, 1)

  arr.myForeach{
    element -&gt; 
      print("$element ");
  }
}
                  </pre
        >
      </div>
    </div>

    <p>مثال:</p>

    <p>
      در زیر یک تابع مرتبه بالا داریم که کارکتر های تصادفی درست میکنه و با
      استفاده از accessible با هربار تولید کارکتر میتونیم به اون کارکتر به صورت
      Callback توسط لامبدا دسترسی داشته باشیم و در پایان کار تابع همه ی کاراکتر
      ها رو به صورت String بر میگردونه.
    </p>

    <div class="sample">
      <div class="snippet-container">
        <pre class="snippet Kotlin">
fun main(){

  val NUMBER_OF_CHARS_PER_LINE = 12
  
  println("Printing random chars")
  //صدا زدن تابع
  val randomChars: String = generateRandomChars(200, 'A', 'Z') { //اختصاص دادن لامبدا به اخرین پارامتر
    ch , index -&gt;

        
    if((index + 1) % NUMBER_OF_CHARS_PER_LINE == 0) println(ch)
      else print(ch)

  }

  println("Returned chars from generateRandomChars: ")

  println(randomChars)
  
}

//تعریف تابع
fun generateRandomChars(length: Int, startRange: Char, endRange: Char, accessible: (generated: Char, index: Int) -&gt; Unit): String{
  
  val start = startRange.code
  val end = endRange.code

  var result = ""

  for(index in 0 until length){
    val ch = (start + Math.random() * (end - start + 1)).toInt().toChar()

    //صدا زدن لامبدا    
    accessible(ch, index)

    result += ch
  }

  return result

}
                  </pre
        >
      </div>
    </div>

    <h3>تعریف تابع تحت لفظی با receiver به عنوان پارامتر</h3>

    <div class="note">
      <p class="note-head">توجه:</p>
      <p>
        برای درک بهتر این قسمت خوبه که با شی گرایی و ساخت نمونه از کلاس اشنایی
        داشته باشید
      </p>
    </div>

    <p>
      میتونیم
      <a
        href="/post/kotlin/anonymous-function-and-lambda.html"
        class="text-decoration-none"
        >توابع تحت لفظی با رسیور</a
      >
      رو به عنوان پارامتر برای تابع مرتبه بالا تعریف کنیم. مهم ترین کاربردشون در
      type-safe builder ها است.
    </p>

    <p>مثال:</p>

    <p>
      مثال زیر در وبسایت رسمی کاتلین قرار داره و نشون میده توابعی که در کاتلین
      برای ایجاد تگ های html وجود دارن چطور تعریف شدن.
    </p>

    <p>این مثال فقط برای تفهیم موضوعه و قابل اجرا نیست.</p>

    <div class="sample">
      <div class="snippet-container">
        <pre class="snippet Kotlin">
class HTML {
    fun body() { ... }
}

fun html(init: HTML.() -&gt; Unit): HTML {
    val h = HTML()  // ساخت نمونه از رسیور
    h.init()        // صدا زدن عبارت لامبدا
    return h
}

html {       // مقداردهی عبارت لامبدا با رسیور به عنوان پارامتر تابع
    ...
    body()   // صدا زدن اعضای رسیور
    ...
}
                  </pre
        >
      </div>
    </div>
  </section>

  <section id="p1">
    <h2>خلاصه</h2>

    <ul>
      <li>در کاتلین توابع first-class هستند</li>
      <li>
        تابع مرتبه بالا به تابعی گفته میشه که حداقل یک تابع به عنوان پارامتر
        دریافت کنه یا یک تابع به عنوان مقدار برگردونه.
      </li>

      <li>
        معمولا از توابع تحت اللفظی به عنوان پارامتر تابع مرتبه بالا استفاده
        میشه.
      </li>

      <li>
        میتونیم از پارامتر هایی که با توابع تحت اللفطی تعریف میکنیم به عنوان
        Callback استفاده کنیم.
      </li>
      <li>
        تابع setOnClickListener در api اپلیکیشن ها از جمله اندروید، توابع مرتبه
        بالا هستند.
      </li>

      <li>
        میتونیم تابع با رسیور رو به عنوان پارامتر تابع مرتبه بالا تعریف کنیم.
      </li>

      <li>
        با تعریف تابع با رسیور به عنوان پارامتر تابع مرتبه بالا میتونیم
        type-safe builder تعریف کنیم.
      </li>
    </ul>
  </section>
</article>

{% capture links %}
<li>
  <a href="/post/kotlin/functions.html">توابع در کاتلین</a>
</li>

<li>
  <a href="/post/kotlin/extension-function.html">اکستنشن ها در کاتلین</a>
</li>

<li>
  <a href="/post/kotlin/anonymous-function-and-lambda.html"
    >توابع بی نام و عبارات لامبدا در کاتلین</a
  >
</li>

<li>
  <a href="https://kotlinlang.org/docs/lambdas.html"
    >سایت رسمی کاتلین برای مطالعه موضوع</a
  >
</li>
{% endcapture %} {% include article-foot.html relative_links = links %}
